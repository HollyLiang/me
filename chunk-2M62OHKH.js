import{$b as I,C as f,S as i,V as n,Zb as g,jc as S,o as c,r as u,t as h}from"./chunk-FSJNGWZP.js";var d=(()=>{class e{constructor(){this.PREFIX="HY"}setItem(t,r){localStorage.setItem(this.getTransKey(t),r)}getItem(t){return localStorage.getItem(this.getTransKey(t))||""}getTransKey(t){return this.PREFIX+t.toUpperCase()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var a=(()=>{class e{constructor(t){this.localStorage=t}set accessToken(t){this.localStorage.setItem("AccessToken",t)}get accessToken(){return this.localStorage.getItem("AccessToken").toString()}set account(t){this.localStorage.setItem("Account",t.toString())}get account(){return this.localStorage.getItem("Account")}set rememberMe(t){this.localStorage.setItem("RememberMe",t.toString())}get rememberMe(){return this.localStorage.getItem("RememberMe")==="true"}set userInfo(t){this.localStorage.setItem("userInfo",JSON.stringify(t))}get userInfo(){let t=this.localStorage.getItem("userInfo");return t&&JSON.parse(t)||null}static{this.\u0275fac=function(r){return new(r||e)(n(d))}}static{this.\u0275prov=i({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var P=(()=>{class e{constructor(t,r){this.router=t,this.userService=r}intercept(t,r){let o=t.url;if(this._isCallAPI(o)){let s={};o&&o.startsWith("~/")&&(s.url=o.replace("~/",""));let m=this.userService.accessToken;m&&(s.headers={"access-token":m}),t=t.clone(s)}return r.handle(t).pipe(h(s=>s instanceof g?this._handleResponse(s,o):c(s)),f(s=>this._handleResponse(s,o)))}_handleResponse(t,r){if(this._isCallAPI(r)===!1)return c(t);switch(this._handleAccessToken(t),t.status){case 200:return c(t);case 400:throw new Error("400");case 401:this._navigateTo("auth/login");break}}_isCallAPI(t){return t.toLocaleLowerCase().startsWith("~/api")}_handleAccessToken(t){let r=t.headers.get("set-access-token");r&&(this.userService.accessToken=r)}_navigateTo(t){this.router.navigateByUrl(t)}static{this.\u0275fac=function(r){return new(r||e)(n(S),n(a))}}static{this.\u0275prov=i({token:e,factory:e.\u0275fac})}}return e})();var O=(()=>{class e{constructor(t,r){this.http=t,this.userService=r}signIn(t,r){let o={account:t,password:r};return this.http.post("~/api/auth/signIn",o).pipe(u(l=>(this.userService.userInfo=l,l)))}signOut(){return this.http.post("~/api/auth/signOut",null).pipe(u(t=>(this.userService.accessToken=null,t)))}static{this.\u0275fac=function(r){return new(r||e)(n(I),n(a))}}static{this.\u0275prov=i({token:e,factory:e.\u0275fac})}}return e})();var K={serverUrl:"http://localhost:5031/",production:!0};export{a,P as b,O as c,K as d};
